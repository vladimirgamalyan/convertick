<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UTF-8 to binary and back converter</title>
    <script>
        window.onload = function() {
            const regexBinary = /^[01]+$/;
            let utf8Encoder = new TextEncoder();
            let utf8Decoder = new TextDecoder();

            function updateInputValue(e) {
                let encoded = utf8Encoder.encode(e.target.value);
                let result = ''
                for (let b of encoded) {
                    result += b.toString(2).padStart(8, "0");
                }
                textAreaOutput.value = result;
            }

            function updateOutputValue(e) {
                const s = e.target.value;
                const l = s.length;
                if (l % 8 || !regexBinary.test(s)) {
                    textAreaInput.value = "";
                } else {
                    const octets = l / 8;
                    let ba = new Uint8Array(octets);
                    for (let i = 0; i < octets; ++i) {
                        ba[i] = parseInt(s.slice(i * 8, i * 8 + 8), 2);
                    }
                    try {
                        textAreaInput.value = utf8Decoder.decode(ba);
                    } catch (error) {
                        textAreaInput.value = "";
                    }
                }
            }

            const textAreaInput = document.getElementById("textAreaInput");
            const textAreaOutput = document.getElementById("textAreaOutput");

            textAreaInput.addEventListener("input", updateInputValue);
            textAreaOutput.addEventListener("input", updateOutputValue);
        };
    </script>
    <style>
        body {
            background-color: #e7eaea;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div><label for="textAreaInput">UTF-8</label></div>
    <textarea id="textAreaInput" rows="4" cols="40" autofocus></textarea>
    <div><label for="textAreaOutput">Binary</label></div>
    <textarea id="textAreaOutput" rows="16" cols="40"></textarea>
    <div><a href="https://github.com/vladimirgamalyan/convertick">GitHub</a></div>
</body>
</html>
